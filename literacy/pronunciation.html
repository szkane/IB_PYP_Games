<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å•è¯å‘éŸ³å­¦ä¹ </title>
  <style>
    /* CSS Variables for theming */
    :root {
      --background-color: #f0f8ff;
      --text-color: #333;
      --primary-color: #1a73e8;
      --primary-hover-color: #1557b0;
      --border-color: #dfe1e5;
      --shadow-color: rgba(32, 33, 36, 0.28);
      --status-color: #5f6368;
      --font-family: 'Microsoft YaHei', sans-serif;
    }

    /* Dark Mode */
    .dark-mode {
      --background-color: #222;
      --text-color: #eee;
      --primary-color: #64b5f6;
      --primary-hover-color: #42a5f5;
      --border-color: #444;
      --shadow-color: rgba(0, 0, 0, 0.5);
      --status-color: #ccc;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      font-family: var(--font-family);
      background: var(--background-color);
      color: var(--text-color);
      transition: background 0.3s, color 0.3s;
      /* Smooth transition for theme change */
    }

    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 10vh;
      width: 90%;
      max-width: 600px;
    }

    .logo {
      font-size: 4rem;
      margin-bottom: 2rem;
      color: var(--primary-color);
      font-weight: bold;
    }

    .search-box {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }

    .search-input {
      width: 100%;
      height: 44px;
      border: 1px solid var(--border-color);
      border-radius: 24px;
      padding: 0 20px;
      font-size: 16px;
      outline: none;
      box-shadow: none;
      transition: box-shadow 0.3s, border-color 0.3s;
      background-color: transparent;
      /* Make the input field transparent */
      color: var(--text-color);
    }

    .search-input:hover,
    .search-input:focus {
      box-shadow: 0 1px 6px var(--shadow-color);
      border-color: var(--primary-color);
    }

    .buttons {
      margin-top: 20px;
      display: flex;
      gap: 10px;
    }

    .button {
      background-color: var(--primary-color);
      border: 1px solid var(--primary-color);
      border-radius: 4px;
      color: white;
      font-size: 14px;
      padding: 0 16px;
      height: 36px;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
    }

    .button:hover {
      background-color: var(--primary-hover-color);
      border-color: var(--primary-hover-color);
      box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
    }

    .status {
      margin-top: 20px;
      color: var(--status-color);
      font-size: 14px;
    }

    #downloadBtn {
      display: none;
      margin-top: 10px;
      text-decoration: none;
      background-color: var(--primary-color);
      color: white;
      padding: 8px 16px;
      border-radius: 4px;
      font-size: 14px;
      transition: background-color 0.3s;
    }

    #downloadBtn:hover {
      background-color: var(--primary-hover-color);
    }

    /* Responsive Design */
    @media (max-width: 600px) {
      .logo {
        font-size: 3rem;
      }

      .search-input {
        font-size: 14px;
      }

      .button {
        font-size: 12px;
        padding: 0 12px;
      }
    }

    /* Theme Toggle Button */
    .theme-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      cursor: pointer;
      background-color: transparent;
      border: none;
      font-size: 24px;
      color: var(--text-color);
    }

  </style>
</head>

<body>
  <button class="theme-toggle" id="themeToggle">â˜€ï¸</button>
  <div class="container">
    <div class="logo">Pronunciation</div>
    <div class="search-box">
      <input type="text" class="search-input" placeholder="è¾“å…¥è¦æœ—è¯»çš„å•è¯..." id="wordInput">
      <div class="buttons">
        <button class="button" onclick="getAudio('en-US')">ç¾å¼å‘éŸ³</button>
        <button class="button" onclick="getAudio('en-GB')">è‹±å¼å‘éŸ³</button>
      </div>
    </div>
  </div>

  <div class="container" style="margin-top: 50px;">
    <div class="search-box">
      <select id="voiceSelect" class="search-input" style="margin-bottom: 20px;">
        <option value="">é€‰æ‹©è¯­éŸ³</option>
      </select>
      <button class="button" onclick="useBrowserTTS()">ä½¿ç”¨Browser TTS</button>
    </div>
  </div>
  <div class="status" id="status"></div>
  <script>
    // Theme Toggle Logic
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;

    themeToggle.addEventListener('click', () => {
      body.classList.toggle('dark-mode');
      if (body.classList.contains('dark-mode')) {
        themeToggle.textContent = 'ğŸŒ™';
      } else {
        themeToggle.textContent = 'â˜€ï¸';
      }
    });

    // è·å–æµè§ˆå™¨æ”¯æŒçš„è¯­éŸ³åˆ—è¡¨
    function populateVoiceList() {
      const voices = speechSynthesis.getVoices();
      const voiceSelect = document.getElementById('voiceSelect');
      const currentSelection = voiceSelect.value;  // Store current selection

      // Clear existing options except the first one
      while (voiceSelect.options.length > 1) {
        voiceSelect.remove(1);
      }

      voices.forEach(voice => {
        if (voice.lang.startsWith('en')) {
          const option = document.createElement('option');
          option.value = voice.name;
          option.textContent = `${voice.name} (${voice.lang})`;
          voiceSelect.appendChild(option);

          // Restore previous selection if it matches
          if (voice.name === currentSelection) {
            option.selected = true;
          }
        }
      });
    }

    // åˆå§‹åŒ–æ—¶è·å–è¯­éŸ³åˆ—è¡¨
    populateVoiceList();
    if (speechSynthesis.onvoiceschanged !== undefined) {
      speechSynthesis.onvoiceschanged = populateVoiceList;
    }

    // ä½¿ç”¨Browser TTSæ’­æ”¾
    function useBrowserTTS() {
      const word = document.getElementById('wordInput').value.trim();
      const voiceSelect = document.getElementById('voiceSelect');
      const selectedVoice = voiceSelect.value;

      if (!word) {
        document.getElementById('status').textContent = 'è¯·è¾“å…¥å•è¯';
        return;
      }

      if (!selectedVoice) {
        document.getElementById('status').textContent = 'è¯·é€‰æ‹©è¯­éŸ³';
        return;
      }

      document.getElementById('status').textContent = 'æ­£åœ¨æ’­æ”¾å‘éŸ³...';

      try {
        const utterance = new SpeechSynthesisUtterance(word);
        const voices = speechSynthesis.getVoices();
        utterance.voice = voices.find(voice => voice.name === selectedVoice);

        utterance.onend = function () {
          document.getElementById('status').textContent = '';
        };

        speechSynthesis.speak(utterance);
      } catch (error) {
        console.error('Error:', error);
        document.getElementById('status').textContent = 'æ’­æ”¾å‘éŸ³æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•';
      }
    }

    function getAudio(accent) {
      const word = document.getElementById('wordInput').value.trim();
      if (!word) {
        document.getElementById('status').textContent = 'è¯·è¾“å…¥å•è¯';
        return;
      }

      document.getElementById('status').textContent = 'æ­£åœ¨æ’­æ”¾å‘éŸ³...';

      try {
        const utterance = new SpeechSynthesisUtterance(word);
        utterance.lang = accent;
        utterance.rate = 0.8;

        // æ·»åŠ æ’­æ”¾ç»“æŸäº‹ä»¶å¤„ç†
        utterance.onend = function () {
          document.getElementById('status').textContent = '';
        };

        speechSynthesis.speak(utterance);
      } catch (error) {
        console.error('Error:', error);
        document.getElementById('status').textContent = 'æ’­æ”¾å‘éŸ³æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•';
      }
    }
  </script>
</body>

</html>
